---
# yaml-language-server: $schema=https://taskfile.dev/schema.json
version: '3'

vars:
  BOOTSTRAP_SCRIPT: '{{.SCRIPTS_DIR}}/bootstrap-talos.sh'

tasks:

  default:
    desc: Bootstrap Talos and Kubernetes cluster
    cmd: bash {{.BOOTSTRAP_SCRIPT}}
    preconditions:
      - find --version | grep -q GNU
      - test -f {{.BOOTSTRAP_SCRIPT}}
      - which gum helm helmfile kubectl op talosctl yq
